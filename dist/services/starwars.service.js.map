{"version":3,"sources":["../../src/services/starwars.service.js"],"names":["StarWarsApiService","cacheManager","CacheManager","API","planetName","getKey","cachedPlanets","planet","JSON","parse","find","name","films","length","hasNextPage","allPlanets","request","axios","get","api","planets","data","results","push","next","setKey"],"mappings":";;;;;;;;AAAA;;;;AACA;;;;;;;;;;IAEqBA,kB;AACjB,kCAAc;AAAA;;AACV,aAAKC,YAAL,GAAoB,IAAIC,sBAAJ,EAApB;AACA,aAAKC,GAAL,GAAW,sBAAX;AACH;;;;;gGAE+BC,U;;;;;;;;uCACF,KAAKH,YAAL,CAAkBI,MAAlB,CAAyB,SAAzB,C;;;AAAtBC,6C;;qCACDA,a;;;;;AACKC,sC,GAASC,KAAKC,KAAL,CAAWH,aAAX,EAA0BI,IAA1B,CAA+B;AAAA,2CAAUH,OAAOI,IAAP,IAAeP,UAAzB;AAAA,iCAA/B,C;iEACNG,OAAOK,KAAP,CAAaC,M;;;AAEhBC,2C,GAAc,I;AACdC,0C,GAAa,E;;AACjB,uCAAMD,WAAN,EAAkB;AACVE,2CADU,GACAC,gBAAMC,GAAN,CAAa,KAAKC,GAAlB,sBADA;AAEVC,4CAFU,GAEAJ,QAAQK,IAAR,CAAaC,OAFb;;AAGdP,+CAAWQ,IAAX,CAAgBH,QAAhB;AACAN,kDAAcE,QAAQK,IAAR,CAAaG,IAA3B;AACH;AACD,qCAAKvB,YAAL,CAAkBwB,MAAlB,CAAyB,SAAzB,EAAoCL,OAApC;iEACOL,WAAWL,IAAX,CAAgB;AAAA,2CAAUH,OAAOI,IAAP,IAAeP,UAAzB;AAAA,iCAAhB,C;;;;;;;;;;;;;;;;;;;;;kBArBEJ,kB","file":"starwars.service.js","sourcesContent":["import CacheManager from \"../application/CacheManager\";\r\nimport axios from 'axios';\r\n\r\nexport default class StarWarsApiService {\r\n    constructor() { \r\n        this.cacheManager = new CacheManager();\r\n        this.API = 'https://swapi.co/api';\r\n    }\r\n\r\n    async getMovieApparitionsNumber(planetName){\r\n        let cachedPlanets = await this.cacheManager.getKey('planets');\r\n        if(cachedPlanets){\r\n            let planet = JSON.parse(cachedPlanets).find(planet => planet.name == planetName);\r\n            return planet.films.length;\r\n        } else {\r\n            var hasNextPage = true;\r\n            var allPlanets = [];\r\n            while(hasNextPage){\r\n                let request = axios.get(`${this.api}/planets/?page=1`);\r\n                let planets = request.data.results;\r\n                allPlanets.push(planets);\r\n                hasNextPage = request.data.next;\r\n            }\r\n            this.cacheManager.setKey('planets', planets);\r\n            return allPlanets.find(planet => planet.name == planetName);\r\n        }\r\n    }\r\n}"]}